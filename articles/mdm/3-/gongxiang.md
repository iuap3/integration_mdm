# 主数据建立及共享

主数据建立主要包括主数据装载（包括从业务系统采集主数据或将本地Excel形式的主数据批量导入到主数据管理系统）及主数据映射（主数据编码与业务系统业务数据的映射）两方面。同时，主数据管理依据不同的数据权限控制，可以向不同的业务系统进行主数据的共享，以保持整个企业IT环境主数据的一致性。MDM3.0版本还新增了血缘关系功能，可方便追踪主数据的变更信息。

## 主数据权限

单击【主数据管理】→【主数据建立/共享】→【主数据权限】，进入主数据权限页面，在该页面里，左边是由【主数据管理】→【系统管理】→【业务系统注册】创建的业务系统树，右边是该业务系统的数据权限。

主数据管理的数据权限是业务系统粒度的，主要控制分享过程中，数据的分发范围。

● 新增

单击业务系统树的某个业务系统，单击〖新增〗，弹出“新增权限”窗口。

在页面上方输入相关内容，包括：

→ 权限编码。必输项，若先选择主数据，则会自动匹配到主数据的编码和名称；

→ 权限名称。必输项；

→ 主数据：必输项。单击

![](/articles/mdm/3-/images/image46.png)

弹出“主数据参照”窗口，定位选择跟这个业务系统相关的主数据。选择后，在“主数据属性权限控制”列表会显示该主数据所包含的全部属性；

→ 主数据权限：有查询、新增、更新、删除、订阅的权限，通过复选框进行选择，如果选择了“订阅”，则在审批流程中，流程结束，自动进行主数据发送（主数据分发按照分发策略分为手动分发、实时分发、定时分发三种，此处选择“订阅”即为实时分发）；主数据被删除触发订阅分发，业务系统调用主数据删除服务接口后，如果该业务系统有订阅服务，MDM会触发分发，把删除信息及时通知相关业务系统；

→ 扩展接口：目前只支持动态修改查询条件的接口。

→ 分发条件：点击“条件编辑”用户可对当前主数据的各属性进行条件的编辑，之后会自动生成相应的SQL语句，用户也可以书写SQL的WHERE语句对数据进行过滤条件的编辑（高级管理员使用）；

在“属性权限控制”列表，用户可对该主数据下各个属性的新增，更新，查询权限进行勾选。其中，新增数据权限也可用于主数据装载过程。

![](/articles/mdm/3-/images/image47.png)

图：主数据权限

单击〖确认〗，保存。

● 查看

单击业务系统树的某个业务系统，页面右边显示该业务系统的全部数据权限。

● 修改

单击业务系统树的某个业务系统，单击〖修改〗，弹出“数据权限”窗口，修改相关内容，单击〖确认〗保存。

● 删除

单击〖删除〗，会弹出删除确认框，单击〖是〗。

## 主数据装载

点击【主数据管理】→【主数据建立/共享】→【主数据装载】，进入主数据装载页面。

主数据管理的装载，是两步操作。第一步是抓取数据，即把数据预加载到主数据管理，可通过选择远程数据或本地数据进行装载数据的选取。第二步是保存，即把装载后数据保存到数据库里。

主数据装载支持多子表。

● 主数据装载

1、单击“远程系统”右侧的

![](/articles/mdm/3-/images/image48.png)

弹出窗口，对业务系统进行定位选择；

2、单击“主数据类型”右侧的

![](/articles/mdm/3-/images/image49.png)

弹出窗口，对要加载的主数据进行定位选择；

3、单击〖装载数据〗，选择远程数据或本地数据（选择本地的Excel文件）。在下方列表会显示加载的数据列表（显示列：名称，编码，描述），可以勾选行头的复选框进行数据的过滤（可全选）。单击〖清除数据〗，清空全部数据；

![](/articles/mdm/3-/images/image50.png)

图：主数据加载

4、单击〖保存〗；

5、加载过程中的可能错误

→ 在采集过程中，如果违反数据权限定义的规则，数据加载不成功，会弹出相应的提示框。

![](/articles/mdm/3-/images/image51.png)

图：错误信息框

→ 在采集过程中，如果业务系统提供的服务程序报错，数据加载失败。

![](/articles/mdm/3-/images/image52.png)

图：错误信息框

![](/articles/mdm/3-/images/image168.png)

## 主数据分发

单击【主数据管理】→【主数据建立/共享】→【主数据分发】，进入主数据分发页面，在该页面左侧是由【主数据管理】→【主数据建模】→【主数据定义】创建的主数据，右侧是分发的相应选择操作区域。

主数据分发支持多子表。

![](/articles/mdm/3-/images/image53.png)

图：主数据分发

● 主数据分发

(1) 单击“主数据”后边的

![](/articles/mdm/3-/images/image54.png)

弹出窗口进行主数据的定位选择，单击〖确认〗。

![](/articles/mdm/3-/images/image55.png)

图：选择主数据

(2) 单击远程系统

![](/articles/mdm/3-/images/image56.png)

弹出下拉窗口进行业务系统的定位选择，单击〖确认〗。

![](/articles/mdm/3-/images/image57.png)

图：选择远程系统

(3) 选择主数据是否级联查询，设置主数据分发是否包含该主数据对应的级联数据。

● 分发

![](/articles/mdm/3-/images/image53.png)

图：主数据分发操作

单击〖分发〗，完成主数据的分发功能，成功后提示分发成功。以邮件方式通知相关的分发业务系统，方便业务系统的相关人员及时进行业务处理。

● 失败重发

单击〖失败重发〗，列出主数据向远程系统发送失败的记录，选择要重发的记录，单击〖重发〗。

## 主数据映射

点击【主数据管理】→【主数据建立/共享】→【主数据映射】，进入主数据映射页面。页面左边是常主数据分类树，右边是主数据映射列表。

主数据映射关系导入导出支持多子表。

![](/articles/mdm/3-/images/image58.png)

图：主数据映射

● 导出

左侧选择主数据实体，单击远程系统

![](/articles/mdm/3-/images/image59.png)

弹出窗口进行业务系统的定位选择，单击〖确认〗，可列出当前主数据的映射关系列表。

单击〖导出〗，选择导出范围，会将相应数据以Excel表格形式保存。若选择导出未映射数据，则可手动在导出表中进行映射关系的补齐。

![](/articles/mdm/3-/images/image60.png)

图：导出主数据映射

● 导入

单击〖导入〗，选择要导入的映射关系文件，可将未映射的数据通过手动建立业务系统与主数据的映射关系后导入到主数据映射中。

## 分发任务配置

点击【主数据管理】→【主数据建立/共享】→【分发任务配置】，进入分发任务配置页面。页面上边是新增、修改、删除分发任务操作，下边是分发任务列表。这里的分发任务是指分发策略中的定时分发。

![](/articles/mdm/3-/images/image61.png)

图：分发任务配置

● 新增

单击〖新增〗按钮，弹出“增加分发条件”的窗口，填写相应内容（|表示必填项），其中查询条件可单击〖条件编辑〗，对所选择的主数据的属性进行条件的编辑，也可自己输入SQL语句。

单击〖确认〗完成分发条件的编辑。

建立好分发任务后，进入后台任务配置界面进行定时任务的参数及触发配置。

注意：这里的查询条件与主数据权限的分发条件是and的关系。

![](/articles/mdm/3-/images/image62.png)

图：增加分发条件

● 修改

选择一条分发任务，单击〖修改〗，弹出“修改分发条件”窗口，修改相应内容后，单击〖保存〗。

![](/articles/mdm/3-/images/image63.png)

图：修改分发任务

● 删除

在分发任务列表选择一条任务，单击〖删除〗，选择〖是〗，完成删除操作。

![](/articles/mdm/3-/images/image64.png)

图：删除分发任务

## 血缘关系

点击【主数据管理】→【主数据建立/共享】→【血缘关系】，进入血缘关系页面。页面左侧是主数据的分类树，右边是相应的主数据列表及血缘关系列表。

单击主数据列表的每条主数据，血缘关系列表会列出当前主数据的所有记录，包括主数据更改、装载、分发、合并、排重操作的主数据版本、变更人、系统、变更时间等信息，便于对当前主数据的历史操作进行追踪。

![](/articles/mdm/3-/images/image65.png)

图：血缘关系

● 主数据条件查询

查询条件如下：

→ 主数据类型；

→ 主数据ID。

输入相关信息，单击〖搜索〗。

即可检索出相应的主数据。

## 分发级联配置

点击【主数据管理】→【主数据建立/共享】→【分发级联配置】，进入分发级联配置页面。在该页面里，左边是业务系统数据树，右边是对主数据分发级联配置的新增，修改，删除等管理。

![](/articles/mdm/3-/images/image66.png)

图：分发级联配置

● 新增

选择业务系统数据的主数据，单击〖新增〗按钮，弹出“新增分发级联配置”的窗口，查询选择业务系统数据对应的主数据权限，勾选添加主数据的级联权限。

![](/articles/mdm/3-/images/image67.png)

图：新增分发级联配置

![](/articles/mdm/3-/images/image68.png)

图：查询业务系统数据的主数据权限

单击〖确认〗完成分发级联的编辑。

● 修改

选择一条分发级联，单击〖修改〗，弹出“修改分发级联”窗口，修改相应内容后，单击〖保存〗。

● 删除

在分发级联列表选择一条任务，单击〖删除〗，选择〖是〗，完成删除操作。

注意：

分发级联配置分为：

1.手动配置：在【主数据建立/共享】→【分发级联配置】，新增、修改、删除分发级联配置信息；

2.后台管理：在【主数据维护】→【主数据分发任务配置】，勾选分发级联配置。 
