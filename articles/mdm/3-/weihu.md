# 主数据维护

主要包括主数据基本维护、查重规则的定义、主数据的合并及主数据日志。对于“主数据”菜单下动态发布的主数据也会涉及维护工作。

## 主数据维护

点击【主数据管理】→【主数据维护】→【主数据维护】，进入主数据编码页面，在该页面里，左边是主数据的分类树，以便主数据的选择，右边是该主数据的操作区域。

对该主数据的操作包括：〖新增〗，〖修改〗，〖删除〗，〖详细信息〗，〖历史记录〗，〖映射关系〗，〖封存〗，〖解封〗。

● 新增

在分类树下选择主数据实体，单击〖新增〗，弹出一个窗口，填写相应内容（|表示必填项）后，单击〖确认〗。

![](/articles/mdm/3-/images/image69.png)

图：新增主数据

新增的主数据，会出现在主数据列表下。

● 修改

选择一条主数据，单击〖修改〗，弹出一个窗口，编辑相应内容后，单击〖保存〗。

![](/articles/mdm/3-/images/image70.png)

图：修改主数据

● 删除

在主数据列表选择一条主数据，单击〖删除〗，选择〖是〗，完成删除操作。

● 详细信息

在主数据列表选择一条主数据，单击〖详细信息〗，可以查看该主数据的详细信息。

● 历史记录

也即是查看主数据的版本，用户可以查看某个历史版本、回退到某个历史版本或进行版本对比。

![](/articles/mdm/3-/images/image71.png)

图：版本数据

注意：当主数据没有做过变更时，会有如下提示

![](/articles/mdm/3-/images/image72.png)

图：错误提示

● 映射关系

在主数据列表选择一条主数据，单击〖映射关系〗，可以查看该主数据与外部系统的映射关系。

● 封存主数据

在主数据列表选择一条主数据，单击〖封存〗，选择〖是〗，完成封存操作。封存后的主数据不能对其进行修改、删除操作。

![](/articles/mdm/3-/images/image73.png)

图：封存主数据

● 解封主数据

在主数据列表选择一条已封存的主数据，单击〖解封〗，弹出解封对话框，选择〖是〗，完成解封操作。

![](/articles/mdm/3-/images/image74.png)

图：解封主数据

在“主数据”菜单下动态发布的主数据有〖下载〗，选定某个主数据，单击〖下载〗，生成Excel文件（文件名为主数据定义的编码）,包含该主数据的全部记录，保存到浏览器所在的机器。

## 查重规则

查重规则是对数据查重时所遵循的规则。

点击【主数据管理】→【主数据维护】→【查重规则】，进入节点页面，在该页面里，左边是主数据的分类树，以便主数据的选择，右边是对主数据排重的操作区域，如下图：

![](/articles/mdm/3-/images/image75.png)

图：查重规则

● 新增

1、单击分类树下的某个数据分类，单击〖新增〗，在弹出窗口填入相应内容：编码（必输项），名称（必输项），描述，同时选择新增规则的排重规则，如下图：

![](/articles/mdm/3-/images/image76.png)

图：新增规则

2、单击〖确认〗，完成规则新增。

排重规则的定义注意事项：

1) 主数据属性都可以选择一个算法。内置算法包括：精确匹配（完全匹配、同音匹配、全半角匹配、简繁体匹配）、模糊匹配。

2) 每一种主数据排重规则要么是精确匹配要么是模糊匹配。

3) 模糊匹配时，需要设置阀值、权重。模糊匹配的大致逻辑是：Σ(属性i查重后相似度*属性i权重)是否大于阀值，大于等于则匹配，小于则不匹配。

4) 模糊匹配的权重可以是任意整数，阀值的数据范围是0,1之间

● 修改

选择规则列表的一条查重规则，单击〖修改〗，在弹出窗口修改编码，名称，描述等，单击〖确认〗保存。

● 删除

选择规则列表的一条查重规则，单击〖删除〗，会弹出删除确认框，单击〖是〗，完成对查重规则删除。

● 查看

选择规则列表的一条查重规则，单击〖查看〗，可以查看此查重规则的详细信息。

## 主数据查重计划任务

一般是集团管理员定义主数据查重计划。每个主数据的查重由两个任务组成。1）主数据查重数据准备2）主数据查重任务。

支持对多子表主数据查重。

1、集团管理员登录自己门户，选择【客户化设置】→【后台任务中心】，单击“后台任务部署”；

![](/articles/mdm/3-/images/image77.png)

图：主数据计划任务中心

2、单击〖增加〗，在各页签填写相关任务配置内容，在参数设置页签，类型选择“主数据查重数据准备”，填写属性名称code取值“要查重的主数据的编码”，保存；

![](/articles/mdm/3-/images/image78.png)

图：后台任务部署1

3、单击〖增加〗，在各页签填写相关任务配置内容，在参数设置页签，选择类型“主数据查重任务”，填写属性名称code取值“主数据查重规则编码”，user取值为“把查重后结果发送谁处理的用户名”，保存。

![](/articles/mdm/3-/images/image79.png)

图：后台任务部署2

4. 该任务会在接受用户的主数据消息中提示。管理员及接受用户在主数据合并业务页面可查看该任务。

![](/articles/mdm/3-/images/image169.png)

## 主数据合并

主数据合并是提高数据质量的方法。它可以结合查重规则，查看任务，指派相关的工作人员进行合并工作；也可以针对某个主数据，自定义选择某些主数据记录，生成一个主数据合并任务，指派给相应的操作人员。该菜单项的功能指后者。

支持对多子表主数据合并。

点击【主数据管理】→【主数据维护】→【主数据合并】，进入节点页面，在该页面里，左边是常用查询以及高级查询，右边是主数据列表及待合并的主数据列表，如下图：

![](/articles/mdm/3-/images/image80.png)

图：主数据合并

1、**选择待合并数据**：查询出主数据后，选择待合并数据，如下图

![](/articles/mdm/3-/images/image81.png)

图：选择待合并数据

2、**指派消息接收者**: 指定接收到合并消息的具体用户，为必选项。

1) 单击指派消息接收者右侧的选择项；

2) 通过左侧页面快速查询人员分组；

3) 选定分组下的具体用户；

4) 单击〖确定〗。

![](/articles/mdm/3-/images/image82.png)

图：接收者选择

3.生成待合并数据：单击〖生成待合并数据〗，如图：

![](/articles/mdm/3-/images/image83.png)

图：生成待合并数据

4.选择〖是〗，完成数据的合并，成功合并后有如下提示图：

![](/articles/mdm/3-/images/image84.png)

图：合并任务生成成功提示

对于被指派合并的用户（业务管理员），

1) 登录自己的门户后，会看到相关“主数据信息”如下图：

![](/articles/mdm/3-/images/image85.png)

图：业务管理员门户

2) 单击“主数据信息”

![](/articles/mdm/3-/images/image86.png)

图：消息中心_查重任务

3) 单击某个查重任务，进入主数据合并页面。

![](/articles/mdm/3-/images/image87.png)

图：主数据合并

合并的注意事项：

1、总共分为合并与排重两个操作。合并会生成一条新记录，新记录会维护与所有合并记录的映射关系；排重是直接剔除掉多余主数据记录，保留一条；

2、合并支持单表，主子表。如果是主子表，主表合并粒度到属性；子表的合并粒度到行。

3、生成主数据合并任务，合并任务里可以只合并部分数据记录，在每条待合并记录前可勾选参与合并的记录，不参与合并的记录映射关系不变。用户选择参与合并的数据大于等于两条。

## 主数据日志

点击【主数据管理】→【主数据维护】→【主数据日志】，进入节点页面。页面左边是常用查询以及高级查询，右边是日志列表。

![](/articles/mdm/3-/images/image88.png)

图：主数据日志

● 查询条件

查询条件：操作类型，操作状态，远程系统，主数据，协同用户，操作时间，操作结果。

主数据日志的操作类型指主数据相关的业务动作，包括：加载，分发，排重，删除，封存，解封，导入导出关系映射，更新，新增等。

操作状态包括：成功或失败。

● 系统日志列表

是一个联动表。单击主表的某一行，在下方的从表里就会显示这条日志相关的主数据操作状态列表。

![](/articles/mdm/3-/images/image89.png)

图：主数据日志

## 主数据审批流程

主数据审批流程没有独立的菜单，它已包含于主数据维护，在“主数据定义”的界面信息中，选择了“流程特性”，则表明该主数据审批流程生效。

用户可以：

1) 流程定义设计

2) 整个流程执行过程中，不同角色的用户参与。

3) 目前主数据流程有：主数据申请、更新、删除。

下面通过一个简单的例子来说主数据审批流程

系统管理员：ml2

用户：user01（已和职责duty关联）

用户2：user02（已和职责duty关联）

→ 以系统管理员身份登录，并在一下各节点进行相应操作，步骤如下：

1、主数据定义：新增主数据，并在主数据信息界面，复选“流程特性”。

![](/articles/mdm/3-/images/image90.png)

图：新增主数据

2、动态节点：发布上一步生成的主数据。

![](/articles/mdm/3-/images/image91.png)

图：发布主数据

3、【系统管理】→【流程管理】→【业务类型】→左侧“业务分类（选中主数据）”，在右侧工作区子表中选择test记录，单击〖维护流程定义〗。

![](/articles/mdm/3-/images/image92.png)

图：流程管理

4、维护流程定义：新增流程定义，设计当前版本（比如较简单的两步：申请人发起和审批人审批）。

![](/articles/mdm/3-/images/image93.png)

图：维护流程定义

5、流程定义设计：开始，人工活动1（设置协同用户：user01，申请发起人），人工活动2(设置协同用户：user02，审批人)，结束。保存

![](/articles/mdm/3-/images/image94.png)

图：流程定义设计

6、启用最新版本。（流程已有效）

7、【系统管理】→【权限管理】→【职责管理】→【职责】--->左侧选择“业务类型”--->右侧选中职责“duty”,选功能按钮“新增资源”，把节点页签下的“test”分配给职责duty（这样，user01和user02就有了对主数据test的操作权限）。

![](/articles/mdm/3-/images/image95.png)

图：分配权限

→ 用户user01发起申请（新增，修改，删除）步骤：

1) 新增主数据，提交。

→ 用户user02审批步骤：

1) 【流程中心】→【任务中心】→【我的工作】--->左侧任务类型“我的办件”，待审批记录就在右侧待审批子表中显示出来。

2) 在“标题”处，点击链接，查看主数据信息，并给出审批意见。

## 主数据合并任务

主数据合并任务是查询、显示主数据合并任务消息列表，处理主数据合并任务。它列出主数据合并任务消息的规则、规则制定人、任务来源、标题、内容、是否处理、处理方式、处理人、处理时间的信息。双击所选主数据合并任务，进入主数据合并任务处理页。根据登陆人不同，显示的数据集不同：管理员登陆可以看到全部数据，业务人员登陆可看到其它处理和待处理的数据。由任务列表页面可进行主数据合并节点。

点击【主数据管理】→【主数据维护】→【主数据合并任务】，进入主数据编码页面。在该页面里，左边是常用查询，右边是主数据合并任务信息列表及合并任务子表信息。

![](/articles/mdm/3-/images/image96.png)

图：主数据合并任务

1、**选择主数据合并任务**：双击选择主数据合并任务，进入主数据合并任务处理页。

2、**主数据合并方式**：单击左上方选项卡：主数据合并、主数据排重；

● 主数据合并：根据系统提示，先设定合并后主数据，对待合并主数据进行主数据合并、清空、移除操作。

![](/articles/mdm/3-/images/image97.png)

图：主数据合并

● 主数据排重：对选定的主数据进行排重、移除操作。

![](/articles/mdm/3-/images/image98.png)

图：主数据排重

合并任务注意事项：

1、任务来源分为：

手动合并：在【主数据维护】→【主数据合并】，配置的主数据合并任务，无规则及规则指定人信息；

后台任务：在【客户化配置】→【编码规则定义全局/集团】，配置的主数据合并任务，显示规则及规则指定人信息。

2、合并任务子表：显示主数据任务处理后，合并主数据ID、名称及状态。
